

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>torchgeometry &mdash; Torchgeometry master documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato" type="text/css" />
  <link rel="stylesheet" href="_static/css/pytorch_theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="#">
          

          
            
            <img src="_static/torchgeometry_logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                master (0.1.0 )
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">torchgeometry</a><ul>
<li><a class="reference internal" href="#pinhole">Pinhole</a></li>
<li><a class="reference internal" href="#conversions">Conversions</a></li>
<li><a class="reference internal" href="#utilities">Utilities</a></li>
<li><a class="reference internal" href="#warping">Warping</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Torchgeometry</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>torchgeometry</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <!-- User defined GitHub URL -->
              <a href="https://github.com/arraiy/torchgeometry" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="torchgeometry">
<h1>torchgeometry<a class="headerlink" href="#torchgeometry" title="Permalink to this headline">¶</a></h1>
<p>The <em>PyTorch Geometry</em> (TGM) package is a geometric computer vision library for <a class="reference external" href="https://pytorch.org/">PyTorch</a>.</p>
<p>It consists of a set of routines and differentiable modules to solve generic geometry computer vision problems. At its core, the package uses <em>PyTorch</em> as its main backend both for efficiency and to take advantage of the reverse-mode auto-differentiation to define and compute the gradient of complex functions.</p>
<p>In this first version, we provide different functions designed mainly for computer vision applications, such as image and tensors warping modules which rely on the epipolar geometry theory. The roadmap will include adding more and more functionality so that developers in the short term can use the package for the purpose of optimizing their loss functions to solve geometry problems.</p>
<p>TGM v0.1.0 focuses on Image and tensor warping functions such as:</p>
<ul class="simple">
<li>Calibration</li>
<li>Epipolar geometry</li>
<li>Homography</li>
<li>Depth</li>
</ul>
<span class="target" id="module-torchgeometry"></span><div class="section" id="pinhole">
<h2>Pinhole<a class="headerlink" href="#pinhole" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The pinhole model is represented in a single vector as follows:</p>
<div class="math notranslate nohighlight">
\[pinhole = (f_x, f_y, c_x, c_y, height, width, r_x, r_y, r_z, t_x, t_y, t_z)\]</div>
<dl class="last docutils">
<dt>where:</dt>
<dd><p class="first"><span class="math notranslate nohighlight">\((r_x, r_y, r_z)\)</span> is the rotation vector in angle-axis convention.</p>
<p class="last"><span class="math notranslate nohighlight">\((t_x, t_y, t_z)\)</span> is the translation vector.</p>
</dd>
</dl>
</div>
<dl class="function">
<dt id="torchgeometry.inverse_pose">
<code class="descclassname">torchgeometry.</code><code class="descname">inverse_pose</code><span class="sig-paren">(</span><em>pose</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/pinhole.html#inverse_pose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.inverse_pose" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverts a 4x4 pose.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>points</strong> (<em>Tensor</em>) – tensor with poses.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tensor with inverted poses.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, 4, 4)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, 4, 4)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pose</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>         <span class="c1"># Nx4x4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pose_inv</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">inverse_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>  <span class="c1"># Nx4x4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.pinhole_matrix">
<code class="descclassname">torchgeometry.</code><code class="descname">pinhole_matrix</code><span class="sig-paren">(</span><em>pinholes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/pinhole.html#pinhole_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.pinhole_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the pinhole matrix from a pinhole model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pinholes</strong> (<em>Tensor</em>) – tensor of pinhole models.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tensor of pinhole matrices.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, 12)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, 4, 4)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pinhole</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>    <span class="c1"># Nx12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pinhole_matrix</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">pinhole_matrix</span><span class="p">(</span><span class="n">pinhole</span><span class="p">)</span>  <span class="c1"># Nx4x4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.inverse_pinhole_matrix">
<code class="descclassname">torchgeometry.</code><code class="descname">inverse_pinhole_matrix</code><span class="sig-paren">(</span><em>pinhole</em>, <em>eps=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/pinhole.html#inverse_pinhole_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.inverse_pinhole_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the inverted pinhole matrix from a pinhole model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pinholes</strong> (<em>Tensor</em>) – tensor with pinhole models.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tensor of inverted pinhole matrices.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, 12)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, 4, 4)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pinhole</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>    <span class="c1"># Nx12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pinhole_matrix_inv</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">inverse_pinhole_matrix</span><span class="p">(</span><span class="n">pinhole</span><span class="p">)</span>  <span class="c1"># Nx4x4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.scale_pinhole">
<code class="descclassname">torchgeometry.</code><code class="descname">scale_pinhole</code><span class="sig-paren">(</span><em>pinholes</em>, <em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/pinhole.html#scale_pinhole"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.scale_pinhole" title="Permalink to this definition">¶</a></dt>
<dd><p>Scales the pinhole matrix for each pinhole model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pinholes</strong> (<em>Tensor</em>) – tensor with the pinhole model.</li>
<li><strong>scale</strong> (<em>Tensor</em>) – tensor of scales.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">tensor of scaled pinholes.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Tensor</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, 12)\)</span> and <span class="math notranslate nohighlight">\((N, 1)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, 12)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pinhole_i</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>    <span class="c1"># Nx12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scales</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Nx1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pinhole_i_scaled</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">scale_pinhole</span><span class="p">(</span><span class="n">pinhole_i</span><span class="p">)</span>  <span class="c1"># Nx12</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.homography_i_H_ref">
<code class="descclassname">torchgeometry.</code><code class="descname">homography_i_H_ref</code><span class="sig-paren">(</span><em>pinhole_i</em>, <em>pinhole_ref</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/pinhole.html#homography_i_H_ref"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.homography_i_H_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>Homography from reference to ith pinhole</p>
<div class="math notranslate nohighlight">
\[H_{ref}^{i} = K_{i} * T_{ref}^{i} * K_{ref}^{-1}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pinhole_i</strong> (<em>Tensor</em>) – tensor with pinhole model for ith frame.</li>
<li><strong>pinhole_ref</strong> (<em>Tensor</em>) – tensor with pinhole model for reference frame.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>tensors that convert depth points (u, v, d) from pinhole_ref to</dt>
<dd><p class="first last">pinhole_i (N, 4, 4).</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Tensor</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, 12)\)</span> and <span class="math notranslate nohighlight">\((N, 12)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, 4, 4)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pinhole_i</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>    <span class="c1"># Nx12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pinhole_ref</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>  <span class="c1"># Nx12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i_H_ref</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">homography_i_H_ref</span><span class="p">(</span><span class="n">pinhole_i</span><span class="p">,</span> <span class="n">pinhole_ref</span><span class="p">)</span>  <span class="c1"># Nx4x4</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="torchgeometry.InversePose">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">InversePose</code><a class="reference internal" href="_modules/torchgeometry/pinhole.html#InversePose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.InversePose" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.PinholeMatrix">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">PinholeMatrix</code><a class="reference internal" href="_modules/torchgeometry/pinhole.html#PinholeMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.PinholeMatrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.InversePinholeMatrix">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">InversePinholeMatrix</code><a class="reference internal" href="_modules/torchgeometry/pinhole.html#InversePinholeMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.InversePinholeMatrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.ScalePinhole">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">ScalePinhole</code><a class="reference internal" href="_modules/torchgeometry/pinhole.html#ScalePinhole"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.ScalePinhole" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.Homography_i_H_ref">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">Homography_i_H_ref</code><a class="reference internal" href="_modules/torchgeometry/pinhole.html#Homography_i_H_ref"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.Homography_i_H_ref" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="conversions">
<h2>Conversions<a class="headerlink" href="#conversions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="torchgeometry.rad2deg">
<code class="descclassname">torchgeometry.</code><code class="descname">rad2deg</code><span class="sig-paren">(</span><em>tensor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/conversions.html#rad2deg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.rad2deg" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts angles from radians to degrees.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tensor</strong> (<em>Tensor</em>) – Tensor to be converted of unspecified shape.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Converted tensor with same shape as input.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.deg2rad">
<code class="descclassname">torchgeometry.</code><code class="descname">deg2rad</code><span class="sig-paren">(</span><em>tensor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/conversions.html#deg2rad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.deg2rad" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts angles from degrees to radians.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tensor</strong> (<em>Tensor</em>) – Tensor to be converted of unspecified shape.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Converted tensor with same shape as input.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="mf">360.</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.convert_points_from_homogeneous">
<code class="descclassname">torchgeometry.</code><code class="descname">convert_points_from_homogeneous</code><span class="sig-paren">(</span><em>points</em>, <em>eps=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/conversions.html#convert_points_from_homogeneous"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.convert_points_from_homogeneous" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts points from homogeneous to Euclidean space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>points</strong> (<em>Tensor</em>) – tensor of N-dimensional points of size (B, D, N).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tensor of N-1-dimensional points of size (B, D, N-1).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((B, D, N)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((B, D, N - 1)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># BxNx3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">convert_points_from_homogeneous</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>  <span class="c1"># BxNx2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.convert_points_to_homogeneous">
<code class="descclassname">torchgeometry.</code><code class="descname">convert_points_to_homogeneous</code><span class="sig-paren">(</span><em>points</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/conversions.html#convert_points_to_homogeneous"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.convert_points_to_homogeneous" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts points from Euclidean to homogeneous space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>points</strong> (<em>Tensor</em>) – tensor of N-dimensional points of size.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tensor of N+1-dimensional points.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((B, D, N)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((B, D, N + 1)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># BxNx3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">convert_points_to_homogeneous</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>  <span class="c1"># BxNx4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.transform_points">
<code class="descclassname">torchgeometry.</code><code class="descname">transform_points</code><span class="sig-paren">(</span><em>dst_pose_src</em>, <em>points_src</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/conversions.html#transform_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.transform_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies batch of transformations to batch of sets of points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dst_pose_src</strong> (<em>Tensor</em>) – tensor for transformations.</li>
<li><strong>points_src</strong> (<em>Tensor</em>) – tensor of points.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">tensor of N-dimensional points.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Tensor</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((B, D+1, D+1)\)</span> and <span class="math notranslate nohighlight">\((B, D, N)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((B, N, D)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># BxNx3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pose</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>   <span class="c1"># Bx4x4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">transform_points</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span> <span class="nb">input</span><span class="p">)</span>  <span class="c1"># BxNx3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.angle_axis_to_rotation_matrix">
<code class="descclassname">torchgeometry.</code><code class="descname">angle_axis_to_rotation_matrix</code><span class="sig-paren">(</span><em>angle_axis</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/conversions.html#angle_axis_to_rotation_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.angle_axis_to_rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert 3d vector of axis-angle rotation to 4x4 rotation matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>angle_axis</strong> (<em>Tensor</em>) – tensor of 3d vector of axis-angle rotations.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tensor of 4x4 rotation matrices.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, 3)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, 4, 4)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># Nx3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">angle_axis_to_rotation_matrix</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>  <span class="c1"># Nx4x4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.rotation_matrix_to_angle_axis">
<code class="descclassname">torchgeometry.</code><code class="descname">rotation_matrix_to_angle_axis</code><span class="sig-paren">(</span><em>rotation_matrix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/conversions.html#rotation_matrix_to_angle_axis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.rotation_matrix_to_angle_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert 4x4 rotation matrix to Rodrigues vector</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rotation_matrix</strong> (<em>Tensor</em>) – rotation matrix.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Rodrigues vector transformation.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, 4, 4)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, 3)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># Nx4x4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">rotation_matrix_to_angle_axis</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>  <span class="c1"># Nx3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.rotation_matrix_to_quaternion">
<code class="descclassname">torchgeometry.</code><code class="descname">rotation_matrix_to_quaternion</code><span class="sig-paren">(</span><em>rotation_matrix</em>, <em>eps=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/conversions.html#rotation_matrix_to_quaternion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.rotation_matrix_to_quaternion" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert 4x4 rotation matrix to 4d quaternion vector</p>
<p>This algorithm is based on algorithm described in
<a class="reference external" href="https://github.com/KieranWynn/pyquaternion/blob/master/pyquaternion/quaternion.py#L201">https://github.com/KieranWynn/pyquaternion/blob/master/pyquaternion/quaternion.py#L201</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rotation_matrix</strong> (<em>Tensor</em>) – the rotation matrix to convert.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the rotation in quaternion</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, 4, 4)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, 4)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># Nx4x4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">rotation_matrix_to_quaternion</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>  <span class="c1"># Nx4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.quaternion_to_angle_axis">
<code class="descclassname">torchgeometry.</code><code class="descname">quaternion_to_angle_axis</code><span class="sig-paren">(</span><em>quaternion</em>, <em>eps=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/conversions.html#quaternion_to_angle_axis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.quaternion_to_angle_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert quaternion vector to angle axis of rotation</p>
<p>Adapted from ceres C++ library: ceres-solver/include/ceres/rotation.h</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>quaternion</strong> (<em>Tensor</em>) – batch with quaternions</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">batch with angle axis of rotation</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, 4)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, 3)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># Nx4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">quaternion_to_angle_axis</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>  <span class="c1"># Nx3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.rtvec_to_pose">
<code class="descclassname">torchgeometry.</code><code class="descname">rtvec_to_pose</code><span class="sig-paren">(</span><em>rtvec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/conversions.html#rtvec_to_pose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.rtvec_to_pose" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert axis-angle rotation and translation vector to 4x4 pose matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rtvec</strong> (<em>Tensor</em>) – Rodrigues vector transformations</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">transformation matrices</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, 6)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, 4, 4)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1"># Nx6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">rtvec_to_pose</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>  <span class="c1"># Nx4x4</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="torchgeometry.RadToDeg">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">RadToDeg</code><a class="reference internal" href="_modules/torchgeometry/conversions.html#RadToDeg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.RadToDeg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.DegToRad">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">DegToRad</code><a class="reference internal" href="_modules/torchgeometry/conversions.html#DegToRad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.DegToRad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.ConvertPointsFromHomogeneous">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">ConvertPointsFromHomogeneous</code><a class="reference internal" href="_modules/torchgeometry/conversions.html#ConvertPointsFromHomogeneous"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.ConvertPointsFromHomogeneous" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.ConvertPointsToHomogeneous">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">ConvertPointsToHomogeneous</code><a class="reference internal" href="_modules/torchgeometry/conversions.html#ConvertPointsToHomogeneous"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.ConvertPointsToHomogeneous" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.TransformPoints">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">TransformPoints</code><a class="reference internal" href="_modules/torchgeometry/conversions.html#TransformPoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.TransformPoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.AngleAxisToRotationMatrix">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">AngleAxisToRotationMatrix</code><a class="reference internal" href="_modules/torchgeometry/conversions.html#AngleAxisToRotationMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.AngleAxisToRotationMatrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.RotationMatrixToAngleAxis">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">RotationMatrixToAngleAxis</code><a class="reference internal" href="_modules/torchgeometry/conversions.html#RotationMatrixToAngleAxis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.RotationMatrixToAngleAxis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.RotationMatrixToQuaternion">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">RotationMatrixToQuaternion</code><a class="reference internal" href="_modules/torchgeometry/conversions.html#RotationMatrixToQuaternion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.RotationMatrixToQuaternion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.QuaternionToAngleAxis">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">QuaternionToAngleAxis</code><a class="reference internal" href="_modules/torchgeometry/conversions.html#QuaternionToAngleAxis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.QuaternionToAngleAxis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="torchgeometry.RtvecToPose">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">RtvecToPose</code><a class="reference internal" href="_modules/torchgeometry/conversions.html#RtvecToPose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.RtvecToPose" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="utilities">
<h2>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="torchgeometry.inverse">
<code class="descclassname">torchgeometry.</code><code class="descname">inverse</code><span class="sig-paren">(</span><em>transforms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/utils.html#inverse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Batched version of <cite>torch.inverse</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>transforms</strong> (<em>Tensor</em>) – tensor of transformations of size (B, D, D).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tensor of inverted transformations of size (B, D, D).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Tensor</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.tensor_to_image">
<code class="descclassname">torchgeometry.</code><code class="descname">tensor_to_image</code><span class="sig-paren">(</span><em>tensor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/utils.html#tensor_to_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.tensor_to_image" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Converts a torch.Tensor image to a numpy image. In case the tensor is in</dt>
<dd>the GPU, it will be copied back to CPU.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tensor</strong> (<em>Tensor</em>) – image of the form (C, H, W).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">image of the form (H, W, C).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)">numpy.ndarray</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.image_to_tensor">
<code class="descclassname">torchgeometry.</code><code class="descname">image_to_tensor</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/utils.html#image_to_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.image_to_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a numpy image to a torch.Tensor image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><em>numpy.ndarray</em></a>) – image of the form (H, W, C).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">image of the form (H, W, C).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)">numpy.ndarray</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="torchgeometry.Inverse">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">Inverse</code><a class="reference internal" href="_modules/torchgeometry/utils.html#Inverse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.Inverse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="warping">
<h2>Warping<a class="headerlink" href="#warping" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torchgeometry.HomographyWarper">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">HomographyWarper</code><span class="sig-paren">(</span><em>height</em>, <em>width</em>, <em>points=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/homography_warper.html#HomographyWarper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.HomographyWarper" title="Permalink to this definition">¶</a></dt>
<dd><p>Warps patches by homographies.</p>
<div class="math notranslate nohighlight">
\[X_{dst} = H_{dst}^{src} * X_{src}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The width of the image to warp.</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The height of the image to warp.</li>
<li><strong>points</strong> (<em>Tensor</em>) – Tensor[3, N] of homogeneous points in normalized image
space [-1, 1] to sample. Optional parameter.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torchgeometry.HomographyWarper.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>patch</em>, <em>dst_homo_src</em>, <em>padding_mode='zeros'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/homography_warper.html#HomographyWarper.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.HomographyWarper.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Warps an image or tensor from source into reference frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>patch</strong> (<em>Tensor</em>) – The image or tensor to warp. Should be from source.</li>
<li><strong>dst_homo_src</strong> (<em>Tensor</em>) – The homography or stack of homographies
from source to destination.</li>
<li><strong>padding_mode</strong> (<em>string</em>) – Either ‘zeros’ to replace out of bounds with
zeros or ‘border’ to choose the closest
border data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Patch sampled at locations from source to destination.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Tensor</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, C, H, W)\)</span> and <span class="math notranslate nohighlight">\((N, 3, 3)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, C, H, W)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homography</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warper</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">HomographyWarper</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">warper</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">homography</span><span class="p">)</span>  <span class="c1"># NxCxHxW</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="torchgeometry.HomographyWarper.warp_grid">
<code class="descname">warp_grid</code><span class="sig-paren">(</span><em>H</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/homography_warper.html#HomographyWarper.warp_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.HomographyWarper.warp_grid" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>H</strong> – Homography or homographies (stacked) to transform all points
in the grid.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Tensor[1, Height, Width, 2] containing transformed points in
normalized images space.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="torchgeometry.DepthWarper">
<em class="property">class </em><code class="descclassname">torchgeometry.</code><code class="descname">DepthWarper</code><span class="sig-paren">(</span><em>pinholes</em>, <em>width=None</em>, <em>height=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/depth_warper.html#DepthWarper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.DepthWarper" title="Permalink to this definition">¶</a></dt>
<dd><p>Warps a patch by inverse depth.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}H_{ref}^{i} = K_{i} * T_{ref}^{i} * K_{ref}^{-1}\\I_{ref} = \omega(I_{i}, H_{ref}^{i}, \xi_{ref})\end{aligned}\end{align} \]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pinholes</strong> (<em>Tensor</em>) – The pinhole models for ith frame with shape <cite>[Nx12]</cite>.</li>
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The width of the image to warp. Optional.</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The height of the image to warp. Optional.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torchgeometry.DepthWarper.compute_subpixel_step">
<code class="descname">compute_subpixel_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/depth_warper.html#DepthWarper.compute_subpixel_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.DepthWarper.compute_subpixel_step" title="Permalink to this definition">¶</a></dt>
<dd><p>This computes the required inverse depth step to achieve sub pixel
accurate sampling of the depth cost volume, per camera.</p>
<blockquote>
<div>Szeliski, Richard, and Daniel Scharstein.
“Symmetric sub-pixel stereo matching.” European Conference on Computer
Vision. Springer Berlin Heidelberg, 2002.</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="torchgeometry.DepthWarper.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>inv_depth_ref</em>, <em>patch_i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/depth_warper.html#DepthWarper.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.DepthWarper.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Warps an image or tensor from ith frame to reference given the</dt>
<dd>inverse depth in the reference frame.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inv_depth_ref</strong> (<em>Tensor</em>) – The inverse depth in the reference frame.</li>
<li><strong>patch_i</strong> (<em>Tensor</em>) – The patch in the it frame.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The warped data from ith frame to reference.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Tensor</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, 1, H, W)\)</span> and <span class="math notranslate nohighlight">\((N, C, H, W)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, C, H, W)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># image in ith frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_i</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>       <span class="c1"># NxCxHxW</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># pinholes models for camera i and reference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pinholes_i</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>     <span class="c1"># Nx12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pinhole_ref</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">]),</span>   <span class="c1"># Nx12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create the depth warper and compute the homographies</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warper</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">DepthWarper</span><span class="p">(</span><span class="n">pinholes_i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warper</span><span class="o">.</span><span class="n">compute_homographies</span><span class="p">(</span><span class="n">pinhole_ref</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># warp the ith frame to reference by inverse depth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inv_depth_ref</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>  <span class="c1"># Nx1xHxW</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_ref</span> <span class="o">=</span> <span class="n">warper</span><span class="p">(</span><span class="n">inv_depth_ref</span><span class="p">,</span> <span class="n">img_i</span><span class="p">)</span>    <span class="c1"># NxCxHxW</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="torchgeometry.homography_warp">
<code class="descclassname">torchgeometry.</code><code class="descname">homography_warp</code><span class="sig-paren">(</span><em>patch</em>, <em>dst_H_src</em>, <em>dsize</em>, <em>points=None</em>, <em>padding_mode='zeros'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/homography_warper.html#homography_warp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.homography_warp" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Functional API for <code class="xref py py-class docutils literal notranslate"><span class="pre">torgeometry.HomographyWarper</span></code></p>
</div>
<p>Warps patches by homographies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>patch</strong> (<em>Tensor</em>) – The image or tensor to warp. Should be from source.</li>
<li><strong>dst_homo_src</strong> (<em>Tensor</em>) – The homography or stack of homographies from
source to destination.</li>
<li><strong>dsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – The height and width of the image to warp.</li>
<li><strong>points</strong> (<em>Tensor</em>) – Tensor[3, N] of homogeneous points in normalized image
space [-1, 1] to sample. Optional parameter.</li>
<li><strong>padding_mode</strong> (<em>string</em>) – Either ‘zeros’ to replace out of bounds with
zeros or ‘border’ to choose the closest border
data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Patch sampled at locations from source to destination.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Tensor</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Shape:</dt>
<dd><ul class="first last simple">
<li>Input: <span class="math notranslate nohighlight">\((N, C, H, W)\)</span> and <span class="math notranslate nohighlight">\((N, 3, 3)\)</span></li>
<li>Output: <span class="math notranslate nohighlight">\((N, C, H, W)\)</span></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homography</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">homography_warp</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">homography</span><span class="p">,</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>  <span class="c1"># NxCxHxW</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torchgeometry.depth_warp">
<code class="descclassname">torchgeometry.</code><code class="descname">depth_warp</code><span class="sig-paren">(</span><em>pinholes_i</em>, <em>pinhole_ref</em>, <em>inv_depth_ref</em>, <em>patch_i</em>, <em>width=None</em>, <em>height=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchgeometry/depth_warper.html#depth_warp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchgeometry.depth_warp" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Functional API for <code class="xref py py-class docutils literal notranslate"><span class="pre">torgeometry.DepthWarper</span></code></p>
</div>
<p>Warps a patch by inverse depth.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pinholes_i</strong> (<em>Tensor</em>) – The pinhole models for ith frame with
shape <cite>[Nx12]</cite>.</li>
<li><strong>pinholes_ref</strong> (<em>Tensor</em>) – The pinhole models for the reference frame
with shape <cite>[1x12]</cite>.</li>
<li><strong>inv_depth_ref</strong> (<em>Tensor</em>) – The inverse depth in the reference frame.</li>
<li><strong>patch_i</strong> (<em>Tensor</em>) – The patch data in the ith frame.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The warped data from ith frame to reference.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Tensor</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># image in ith frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_i</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>          <span class="c1"># NxCxHxW</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># pinholes models for camera i and reference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pinholes_i</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>        <span class="c1"># Nx12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pinhole_ref</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">]),</span>      <span class="c1"># Nx12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># warp the ith frame to reference by inverse depth in the reference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inv_depth_ref</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>  <span class="c1"># Nx1xHxW</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_ref</span> <span class="o">=</span> <span class="n">tgm</span><span class="o">.</span><span class="n">depth_warp</span><span class="p">(</span>         <span class="o">&gt;&gt;&gt;</span>     <span class="n">pinholes_i</span><span class="p">,</span> <span class="n">pinhole_ref</span><span class="p">,</span> <span class="n">inv_depth_ref</span><span class="p">,</span> <span class="n">img_i</span><span class="p">)</span>  <span class="c1"># NxCxHxW</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Arraiy, Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'master',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>